@page "/AnalyticHome"
@using System.Net.Http.Json
@inject IDialogService DialogService
<MudContainer Fixed="true" MaxWidth="MaxWidth.ExtraLarge">

    <MudGrid>

        <MudItem xs=12 sm=6>
            <MudButton @onclick="PeriodFilter" Variant="Variant.Filled" Color="Color.Primary">
                @ResForBodyPage.Period
            </MudButton>
        </MudItem>

        <MudItem xs=12 sm=6>
            <MudDateRangePicker PickerVariant="PickerVariant.Inline" Modal="false" />
        </MudItem>

        <MudItem sm="3" xs="6">
            <MudText><b>@element.Name:</b> x </MudText>

        </MudItem>
        <MudItem sm="3" xs="6">
            <MudText><b>@element1.Name:</b> y </MudText>

        </MudItem>
        <MudItem sm="3" xs="6">
            <MudText><b>@element2.Name:</b> z </MudText>

        </MudItem>
        <MudItem xs="6" sm="3"
                 Class="d-flex justify-sm-end justify-center pr-sm-4">
            <MudFab Href="/FormAnalityc"
                Color="Color.Success"
                    StartIcon="@Icons.Material.Filled.AddCircle"
                    Size="Size.Large"
                    Class="my-1" />
        </MudItem>
       @*  <MudItem Width="Auto">
            <MudList T="string">
                <MudListItem Text="Сотрудники" Expanded>
                    <NestedList>

                    <MudListItem>
                        <AvatarContent>
                            <MudAvatar>
                                <!--image-->
                            </MudAvatar>
                        </AvatarContent>
                        <ChildContent>
                            Сотрудник 1
                        </ChildContent>
                    </MudListItem>
                    <MudListItem>
                        <AvatarContent>
                            <MudAvatar>
                                <!--image-->
                            </MudAvatar>
                        </AvatarContent>
                        <ChildContent>
                            Сотрудник 2
                        </ChildContent>
                    </MudListItem>
                    </NestedList>
                </MudListItem>
            </MudList>
        </MudItem> *@
        <MudItem Class="d-flex justify-center flex-grow-1 gap-4">
            <MudDataGrid Filterable="true"  Items="@elements.Take(10)">
                <Columns>
                    <PropertyColumn Property="x => x.Key" Title="Статья" />
                    <PropertyColumn Property="x => x.Value" Title="Количество нарушений" />
                    <PropertyColumn Property="x => x.Value" Title="Новые нарушения" />
                    <PropertyColumn Property="x => x.Value" Title="Ранее учтенные" />
                    <PropertyColumn Property="x => x.Value" Title="Содрудник" />

                </Columns>
            </MudDataGrid>
        </MudItem>
        <MudItem Class=" d-flex justify-center flex-grow-1 gap-4" >

            <MudChart ChartType="ChartType.Pie" InputData="@data" @bind-SelectedIndex="Index" InputLabels="@labels" Width="300px" Height="300px" />
        </MudItem>



    </MudGrid>
</MudContainer>

@code {
    private int Index = 3; //default value cannot be 0 -> first selectedindex is 0.
    int dataSize = 4;
    double[] data = { 77 };
    string[] labels = { "Uranium", "Plutonium", "Thorium", "Caesium", "Technetium", "Promethium",
                        "Polonium", "Astatine", "Radon", "Francium", "Radium", "Actinium", "Protactinium",
                        "Neptunium", "Americium", "Curium", "Berkelium", "Californium", "Einsteinium", "Mudblaznium" };
    Dictionary<int, string> elements = new Dictionary<int, string> { {1, "Uranium" }, {2,"Plutonium" }, {3,"Thorium"}, {4,"Caesium"}, {5,"Technetium"}, {6,"Promethium"},
                        {7,"Polonium"}, {8,"Astatine"}, {9,"Radon"}, {10,"Francium"}, {11,"Radium"}, {12,"Actinium"}, {13,"Protactinium"},
                        {14,"Neptunium"}, {15,"Americium"}, {16,"Curium"}, {17,"Berkelium"}, {18,"Californium"}, {19,"Einsteinium"}, {20,"Mudblaznium"}
};

    Atom element = new Atom { Name = "В работе" };
    Atom element1 = new Atom { Name = "Выполнено" };
    Atom element2 = new Atom { Name = "Всего" };
    public class Atom
    {
        public string Name { get; set; }

    }



    private async Task PeriodFilter()
    {
        var options = new DialogOptions { CloseOnEscapeKey = true };
        var dialoge = await DialogService.ShowAsync<DialogPer>($"{@ResForBodyPage.Period}", options);
        StateHasChanged();
        var changedPeriod = await dialoge.Result;
        if (changedPeriod.Canceled) { StateHasChanged(); }
        else { StateHasChanged(); }

    }
}
